<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø£Ø¯Ù…Ù† - Ø¯Ù„ÙŠÙ„ Ø­Ù„ÙØ§ÙŠØ§ Ø§Ù„Ø·Ø¨ÙŠ</title>
    <link rel="icon" type="image/svg+xml" href="assets/img/Ø§Ù„Ù„ÙˆØºÙˆ Ø¨Ø®Ù„ÙÙŠØ© Ø´ÙØ§ÙØ© (1).svg">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2D89EF">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Ø­Ù„ÙØ§ÙŠØ§ Ø§Ù„Ø·Ø¨ÙŠ">
    <link rel="stylesheet" href="assets/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8RWY9L45TF"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-8RWY9L45TF');
    </script>
</head>
<body>
    <!-- Header with navigation -->
    <header class="header">
        <div class="header-logo">
            <div class="logo-link" style="cursor: default; pointer-events: none;">
                <img src="assets/img/Ø§Ù„Ù„ÙˆØºÙˆ Ø¨Ø®Ù„ÙÙŠØ© Ø´ÙØ§ÙØ© (1).svg" alt="Ø¯Ù„ÙŠÙ„ Ø­Ù„ÙØ§ÙŠØ§ Ø§Ù„Ø·Ø¨ÙŠ" class="logo-image">
                <span>Ø¯Ù„ÙŠÙ„ Ø­Ù„ÙØ§ÙŠØ§ Ø§Ù„Ø·Ø¨ÙŠ - Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø£Ø¯Ù…Ù†</span>
            </div>
        </div>
        <nav>
            <ul class="nav-menu">
                <li class="nav-item"><a href="admin.html" class="nav-link">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a></li>
                <li class="nav-item"><a href="admin-management.html" class="nav-link">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ ÙˆØ§Ù„ØµÙŠØ§Ø¯Ù„Ø©</a></li>
                <li class="nav-item"><a href="#" id="logout-link" class="nav-link">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a></li>
            </ul>
            <div class="menu-toggle">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </nav>
    </header>
    
    <main class="main-content">
        <div class="container">
            <h1 class="page-title">Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø£Ø¯Ù…Ù†</h1>
            
            <!-- Notification Message (hidden by default) -->
            <div id="notification-message" class="notification-message" style="display: none;">
                <p id="notification-text"></p>
            </div>
            
            <!-- Add New Item Section -->
            <section class="admin-section">
                <h2 class="section-title">Ø¥Ø¶Ø§ÙØ© Ø¬Ø¯ÙŠØ¯</h2>
                <div class="admin-add-form-container">
                    <form id="admin-add-form" class="add-form">
                        <div class="form-group">
                            <label for="admin-user-type">Ø§Ù„Ù†ÙˆØ¹</label>
                            <select id="admin-user-type" name="userType" class="form-input" required>
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹</option>
                                <option value="doctor">Ø·Ø¨ÙŠØ¨</option>
                                <option value="pharmacist">ØµÙŠØ¯Ù„ÙŠ</option>
                                <option value="pharmacy">ØµÙŠØ¯Ù„ÙŠØ©</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="admin-full-name">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
                            <input type="text" id="admin-full-name" name="fullName" class="form-input" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="admin-phone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                            <input type="tel" id="admin-phone" name="phone" class="form-input" required>
                        </div>
                        
                        <div class="form-group" id="admin-gender-group" style="display: none;">
                            <label for="admin-gender">Ø§Ù„Ø¬Ù†Ø³</label>
                            <select id="admin-gender" name="gender" class="form-input" required>
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù†Ø³</option>
                                <option value="Ø°ÙƒØ±">Ø°ÙƒØ±</option>
                                <option value="Ø£Ù†Ø«Ù‰">Ø£Ù†Ø«Ù‰</option>
                            </select>
                        </div>
                        
                        <div class="form-group" id="admin-specialty-group" style="display: none;">
                            <label for="admin-specialty">Ø§Ù„Ø§Ø®ØªØµØ§Øµ</label>
                            <input type="text" id="admin-specialty" name="specialty" class="form-input" list="admin-specialty-list" placeholder="Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£Ùˆ Ø§ÙƒØªØ¨ Ø§Ù„ØªØ®ØµØµ">
                            <datalist id="admin-specialty-list">
                                <option value="Ø£Ø·ÙØ§Ù„">Ø£Ø·ÙØ§Ù„</option>
                                <option value="Ù†Ø³Ø§Ø¦ÙŠØ©">Ù†Ø³Ø§Ø¦ÙŠØ©</option>
                                <option value="Ø¹Ø¸Ù…ÙŠØ©">Ø¹Ø¸Ù…ÙŠØ©</option>
                                <option value="Ù‚Ù„Ø¨ÙŠØ©">Ù‚Ù„Ø¨ÙŠØ©</option>
                                <option value="Ø¯Ø§Ø®Ù„ÙŠØ©">Ø¯Ø§Ø®Ù„ÙŠØ©</option>
                                <option value="Ø¹ØµØ¨ÙŠØ©">Ø¹ØµØ¨ÙŠØ©</option>
                                <option value="Ø¹ÙŠÙ†ÙŠØ©">Ø¹ÙŠÙ†ÙŠØ©</option>
                                <option value="Ø£Ù†Ù Ø£Ø°Ù† Ø­Ù†Ø¬Ø±Ø©">Ø£Ù†Ù Ø£Ø°Ù† Ø­Ù†Ø¬Ø±Ø©</option>
                                <option value="Ø·Ø¨ Ø·ÙˆØ§Ø±Ø¦">Ø·Ø¨ Ø·ÙˆØ§Ø±Ø¦</option>
                                <option value="Ø£Ø´Ø¹Ø©">Ø£Ø´Ø¹Ø©</option>
                                <option value="Ø£Ø³Ù†Ø§Ù†">Ø£Ø³Ù†Ø§Ù†</option>
                            </datalist>
                        </div>
                        
                        <div class="form-group">
                            <label for="admin-location">Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                            <input type="text" id="admin-location" name="location" class="form-input">
                        </div>
                        
                        <button type="submit" class="submit-button">Ø¥Ø¶Ø§ÙØ©</button>
                    </form>
                </div>
            </section>
            
            <!-- Pending Submissions Section -->
            <section class="admin-section">
                <h2 class="section-title">Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©</h2>
                <div id="pending-submissions-container" class="admin-cards-container">
                    <!-- Pending submissions will be loaded here -->
                </div>
            </section>
            
            <!-- On-Duty Pharmacy Management Section -->
            <section class="admin-section">
                <div class="admin-on-duty-card">
                    <h3 class="admin-section-title">ğŸ’Š Ø¥Ø¯Ø§Ø±Ø© ØµÙŠØ¯Ù„ÙŠØ© Ø§Ù„Ù…Ù†Ø§ÙˆØ¨Ø©</h3>
                    <div id="on-duty-management-container">
                        <!-- On-duty pharmacy management will be loaded here -->
                    </div>
                </div>
            </section>
        </div>
    </main>
    
    <script src="assets/js/config.js"></script>
    <script src="assets/js/api.js"></script>
    <script src="assets/js/main.js"></script>
    <script>
        // Check if admin is logged in
        document.addEventListener('DOMContentLoaded', async function() {
            // Check authentication
            const token = getAuthToken();
            if (!token) {
                window.location.href = "admin-login.html";
                return;
            }
            
            const admin = await checkAuth();
            if (!admin) {
                removeAuthToken();
                window.location.href = "admin-login.html";
                return;
            }
            
            // Add logout functionality
            const logoutLink = document.getElementById('logout-link');
            if (logoutLink) {
                logoutLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    removeAuthToken();
                    window.location.href = "admin-login.html";
                });
            }
            
            // Load admin panel content (pending submissions and on-duty management only)
            await loadAdminPanel();
            
            // Initialize admin add form
            initializeAdminAddForm();
        });
        
        // Initialize admin add form
        function initializeAdminAddForm() {
            const form = document.getElementById('admin-add-form');
            const userTypeSelect = document.getElementById('admin-user-type');
            const genderGroup = document.getElementById('admin-gender-group');
            const genderSelect = document.getElementById('admin-gender');
            const specialtyGroup = document.getElementById('admin-specialty-group');
            const specialtySelect = document.getElementById('admin-specialty');
            
            // Handle user type change
            if (userTypeSelect) {
                userTypeSelect.addEventListener('change', function() {
                    if (this.value === 'doctor' || this.value === 'pharmacist') {
                        genderGroup.style.display = 'block';
                        genderSelect.setAttribute('required', 'required');
                    } else {
                        genderGroup.style.display = 'none';
                        genderSelect.removeAttribute('required');
                        genderSelect.value = '';
                    }
                    
                    if (this.value === 'doctor') {
                        specialtyGroup.style.display = 'block';
                        specialtySelect.setAttribute('required', 'required');
                    } else {
                        specialtyGroup.style.display = 'none';
                        specialtySelect.removeAttribute('required');
                        specialtySelect.value = '';
                    }
                });
            }
            
            // Add submit event listener
            if (form) {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    submitAdminForm();
                });
            }
        }
    </script>
    
    <!-- Modal for editing -->
    <div id="editModal" class="modal">
      <div class="modal-content">
        <span id="closeModal" class="close-btn">&times;</span>
        <h3 id="modalTitle"></h3>
        <form id="modalForm"></form>
      </div>
    </div>
    
    <footer class="main-footer">
        <!-- Footer will be loaded by footer.js -->
    </footer>
    
    <script src="assets/js/footer.js"></script>
    <script src="assets/js/install-prompt.js"></script>
</body>
</html>